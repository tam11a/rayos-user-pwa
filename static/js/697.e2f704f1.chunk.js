"use strict";(self.webpackChunkrayos_user_pwa=self.webpackChunkrayos_user_pwa||[]).push([[697],{4266:function(e,n,t){var r=t(4165),i=t(5861),s=t(2295),a=t(4193),o=t(8119),l=t(6212),c=t(7131),u=t(7829),d=t(1113),x=t(5898),m=t(4832),p=t(7313),f=t(7890),h=t(1080),j=t(7347),Z=t(860),g=t(7864),v=t(7676),w=t(5883),b=t(1146),y=t(6417);n.Z=function(e){var n,t,k,C,I,P=e.product,S=e.hideBookmark,N=p.useContext(w.Z),W=p.useContext(h.g),F=(0,f.s0)(),E=(0,v.g2)().mutateAsync;return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(s.Z,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",textDecoration:"none",pb:1},component:a.Z,disableRipple:!0,elevation:0,children:[(0,y.jsx)(o.Z,{src:(0,j.FG)(P.image),alt:P.title_en,variant:"square",sx:{height:"85%",width:"100%",bgcolor:"#00000011",color:"primary.dark"},onClick:function(){return F("/product/".concat(P._id))},children:(0,y.jsx)(Z.xUA,{style:{fontSize:"3em"}})}),P.discount?(0,y.jsx)(l.Z,{color:"primary",label:"".concat(P.discount.amount," % OFF!!"),sx:{borderRadius:"2px",position:"absolute",top:"10px",left:"12px"}}):(0,y.jsx)(y.Fragment,{}),P.quantity?(0,y.jsx)(y.Fragment,{}):(0,y.jsx)(l.Z,{color:"error",label:"Out of Stock",sx:{position:"absolute",bottom:"60px",left:"50%",transform:"translateX(-50%)"}}),!S&&W.isVerified?(0,y.jsx)(c.Z,{sx:{position:"absolute",top:"5px",right:"5px","& svg":{filter:"drop-shadow(0px 0px 10px #ffffff)"}},color:"error","aria-label":"add to favorite",onClick:(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.E)((function(){return E(P._id)}));case 2:(n=e.sent).status?N.createSnack(n.msg):N.createSnack(n.msg,"error");case 4:case"end":return e.stop()}}),e)}))),children:null!==(n=W.userInfo)&&void 0!==n&&null!==(t=n.bookmarks)&&void 0!==t&&t.includes(P._id)?(0,y.jsx)(g.M_L,{}):(0,y.jsx)(g.lo,{})}):(0,y.jsx)(y.Fragment,{}),(0,y.jsx)(u.Z,{sx:{height:"100%",width:"100%",display:"flex",textOverflow:"ellipsis"},onClick:function(){return F("/product/".concat(P._id))},children:(0,y.jsx)(d.Z,{variant:"caption",sx:{position:"relative",maxWidth:"100%",fontWeight:"600",fontSize:"1em",pt:.5},noWrap:!0,children:P.titleEn})}),(0,y.jsxs)(u.Z,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},onClick:function(){return F("/product/".concat(P._id))},children:[(0,y.jsxs)(d.Z,{variant:"caption",sx:{position:"relative",maxWidth:"100%",fontWeight:"600","& del":{color:"error.main"}},noWrap:!0,children:[P.price||0," ",P.price!==P.sellPrice&&(0,y.jsx)("del",{children:P.sellPrice})," ","TK"]}),P.rating.count.all?(0,y.jsxs)(x.Z,{direction:"row",alignItems:"center",columnGap:.5,children:[(0,y.jsx)(m.Z,{name:"half-rating-read",defaultValue:null===P||void 0===P||null===(k=P.rating)||void 0===k?void 0:k.total,precision:.1,size:"small",readOnly:!0,sx:{fontSize:"0.9rem"}}),(0,y.jsxs)(d.Z,{variant:"caption",sx:{fontWeight:"600"},children:["(",null===P||void 0===P||null===(C=P.rating)||void 0===C||null===(I=C.count)||void 0===I?void 0:I.all,")"]})]}):(0,y.jsx)(y.Fragment,{})]})]})})}},4697:function(e,n,t){t.r(n),t.d(n,{default:function(){return se}});var r=t(4165),i=t(5861),s=t(885),a=t(7227),o=t(9019),l=t(7829),c=t(5281),u=t(8119),d=t(1689),x=t(2420),m=t(5898),p=t(1113),f=t(7451),h=t(7131),j=t(4193),Z=t(4060),g=t(9536),v=t(4488),w=t(7313),b=t(1080),y=t(6718),k=t(7347),C=t(2524),I=t(6672),P=t(2916),S=t(8648),N=t(7258),W=t(1146),F=t(5883),E=t(1413),_=t(831),D=t(6149),z=t(3604),G=t(6467),L=t(7397),q=t.n(L),R=t(5627),U=t(2539),O=t(9150),B=t(599),Q=t(8268),A=t(6417),M=q().object({userName:q().string().label("Username").required().messages({"string.empty":"Username Required"}),fullName:q().string().label("Name").required().messages({"string.empty":"Name Required"}),email:q().string().label("email")}),H=function(e){var n,t,s,a=e.open,o=e.onClose,l=w.useContext(b.g),c=w.useContext(F.Z),u=(0,N.Sx)(),d=u.mutateAsync,x=u.isLoading,m=(0,R.cI)({resolver:(0,_.L)(M),defaultValues:{userName:null===(n=l.userInfo)||void 0===n?void 0:n.userName,fullName:null===(t=l.userInfo)||void 0===t?void 0:t.fullName,email:null===(s=l.userInfo)||void 0===s?void 0:s.email}}),f=m.reset,Z=m.handleSubmit,g=m.formState.errors,v=m.register,y=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,W.E)((function(){return d(n)}),[201]);case 2:(t=e.sent).status?c.createSnack(t.msg):c.createSnack(t.data,"error");case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return w.useEffect((function(){var e,n,t;return f({userName:null===(e=l.userInfo)||void 0===e?void 0:e.userName,fullName:null===(n=l.userInfo)||void 0===n?void 0:n.fullName,email:null===(t=l.userInfo)||void 0===t?void 0:t.email})}),[a]),(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(D.Z,{open:a,onClose:o,PaperProps:{sx:{width:"95vw",maxWidth:"400px"}},children:[(0,A.jsxs)(z.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,A.jsx)("div",{}),(0,A.jsx)(p.Z,{children:"Edit Profile"}),(0,A.jsx)(h.Z,{size:"small",onClick:o,children:(0,A.jsx)(U.FU5,{})})]}),(0,A.jsx)(O.Z,{isLoading:x}),(0,A.jsx)("form",{onSubmit:Z(y),children:(0,A.jsxs)(G.Z,{sx:{"& > *":{my:1}},children:[(0,A.jsx)(p.Z,{variant:"button",children:"Username"}),(0,A.jsx)(Q.Z,(0,E.Z)({fullWidth:!0,placeholder:"Enter Username"},v("userName"))),(0,A.jsx)(B.Z,{obj:g.userName}),(0,A.jsx)(p.Z,{variant:"button",children:"fullname"}),(0,A.jsx)(Q.Z,(0,E.Z)({fullWidth:!0,placeholder:"Enter Name"},v("fullName"))),(0,A.jsx)(B.Z,{obj:g.fullName}),(0,A.jsx)(p.Z,{variant:"button",children:"email"}),(0,A.jsx)(Q.Z,(0,E.Z)({fullWidth:!0,placeholder:"you@example.com"},v("email"))),(0,A.jsx)(B.Z,{obj:g.email}),(0,A.jsx)(j.Z,{fullWidth:!0,variant:"contained",type:"submit",color:"black",disabled:x,children:"update changes"})]})})]})})},V=t(56),Y=function(e){return k.ZP.postForm("attachments",{"Files[]":e})},J=function(){return(0,V.useMutation)(Y)},K=t(4117),T=t(8359),X=q().object({password:q().string().label("Password").required().messages({"string.empty":"Current Password Required"}),newPassword:q().string().label("New Password").required().messages({"string.empty":"New Password Required"}),confirm_password:q().equal(q().ref("newPassword")).messages({"any.only":"Password Didn't Match!!"})}),$=function(e){var n=e.open,t=e.onClose,r=(0,R.cI)({resolver:(0,_.L)(X)}),i=r.reset,s=r.handleSubmit,a=r.formState,o=a.errors,l=a.isSubmitting,c=r.register;return w.useEffect((function(){return i()}),[n]),(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(D.Z,{open:n,onClose:t,PaperProps:{sx:{width:"95vw",maxWidth:"400px"}},children:[(0,A.jsxs)(z.Z,{sx:{display:"flex",flexDirectin:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,A.jsx)("div",{}),(0,A.jsx)(p.Z,{children:"Reset Password"}),(0,A.jsx)(h.Z,{size:"small",onClick:t,children:(0,A.jsx)(U.FU5,{})})]}),(0,A.jsx)(O.Z,{}),(0,A.jsx)("form",{onSubmit:s(),children:(0,A.jsxs)(G.Z,{sx:{"& > *":{my:1}},children:[(0,A.jsx)(p.Z,{variant:"button",children:"current password"}),(0,A.jsx)(T.Z,(0,E.Z)({fullWidth:!0,placeholder:"Enter Your Password"},c("password"))),(0,A.jsx)(B.Z,{obj:o.password}),(0,A.jsx)(p.Z,{variant:"button",children:"new password"}),(0,A.jsx)(T.Z,(0,E.Z)({fullWidth:!0,placeholder:"Enter New Password"},c("newPassword"))),(0,A.jsx)(B.Z,{obj:o.newPassword}),(0,A.jsx)(p.Z,{variant:"button",children:"confirm password"}),(0,A.jsx)(T.Z,(0,E.Z)({fullWidth:!0,placeholder:"Confirm New Password"},c("confirm_password"))),(0,A.jsx)(B.Z,{obj:o.confirm_password}),(0,A.jsx)(j.Z,{fullWidth:!0,variant:"contained",type:"submit",color:"black",disabled:l,sx:{mt:1},children:"update password"})]})}),(0,A.jsx)(K.Z,{})]})})},ee=t(7676),ne=t(4266),te=t(9466),re=t(5958),ie=function(){var e=w.useContext(F.Z).createSnack,n=w.useState({}),t=(0,s.Z)(n,2),r=(t[0],t[1]),i=w.useState([]),a=(0,s.Z)(i,2),l=a[0],c=a[1],u=(0,ee.BH)({page:1,limit:5}),d=u.data,x=u.isLoading,f=u.isError,h=u.error;return w.useEffect((function(){var n;x||(r(d?null===d||void 0===d?void 0:d.data:{}),c(d?null===d||void 0===d||null===(n=d.data)||void 0===n?void 0:n.data:[]),f&&(400===h.response.status?e(null===h||void 0===h?void 0:h.response.data.msg,"error"):e("Something Went Wrong!","error")))}),[d]),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(g.Z,{}),(0,A.jsxs)(m.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{my:1},children:[(0,A.jsx)(p.Z,{variant:"h6",sx:{textTransform:"capitalize"},children:x?(0,A.jsx)(v.Z,{width:"120px"}):"Wishlist"}),(0,A.jsx)(j.Z,{variant:"contained",size:"small",component:te.rU,to:"/search?wishlist=1",children:"See More"})]}),(0,A.jsx)(g.Z,{}),(0,A.jsx)(o.ZP,{container:!0,direction:"row",rowGap:.6,columnGap:.6,flexWrap:"wrap",sx:{my:2,alignItems:"center",justifyContent:"flex-start"},children:x?(0,A.jsx)(A.Fragment,{children:[1,2,3,4,5,6,7].map((function(e){return(0,A.jsx)(v.Z,{variant:"rectangular",component:o.ZP,item:!0,xs:5.9,sm:3.95,md:2.92,lg:1.97,sx:{height:{xs:"280px",md:"310px"}}},e)}))}):(0,A.jsx)(A.Fragment,{children:null===l||void 0===l?void 0:l.map((function(e){return(0,A.jsx)(o.ZP,{item:!0,xs:5.9,sm:3.85,md:2.92,lg:2.3,sx:{height:{xs:"280px",md:"310px"}},children:(0,A.jsx)(ne.Z,{product:e.product,hideBookmark:!0})},e._id)}))})})]})},se=function(){var e,n,t,v,E,_,D=w.useContext(b.g),z=w.useContext(F.Z),G=w.useState(!1),L=(0,s.Z)(G,2),q=L[0],R=L[1],O=w.useState(!1),B=(0,s.Z)(O,2),Q=B[0],M=B[1],V=w.useState(),Y=(0,s.Z)(V,2),K=Y[0],T=Y[1],X=J(),ee=X.mutateAsync,ne=X.isLoading,te=(0,N.Sx)(),se=te.mutateAsync,ae=te.isLoading,oe=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,W.E)((function(){return ee(K)}),[201]);case 2:if(!(n=e.sent).status){e.next=10;break}return e.next=6,(0,W.E)((function(){var e,t;return se({image:null===(e=n.data)||void 0===e||null===(t=e[0])||void 0===t?void 0:t._id})}),[201]);case 6:(t=e.sent).status?z.createSnack(t.msg):z.createSnack(t.data,"error"),e.next=11;break;case 10:z.createSnack(n.data,"error");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return w.useEffect((function(){K&&oe()}),[K]),D.isVerified?(0,A.jsxs)(a.Z,{sx:{position:"relative",pb:3,pt:"20px"},children:[(0,A.jsx)(o.ZP,{container:!0,spacing:4,children:(0,A.jsxs)(o.ZP,{item:!0,xs:12,sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:"center",rowGap:2,columnGap:4,justifyContent:{xs:"center",sm:"flex-start"}},children:[(0,A.jsxs)(l.Z,{sx:{position:"relative",minHeight:"150px",minWidth:"150px"},component:"form",children:[ne||ae?(0,A.jsx)(l.Z,{sx:{borderRadius:"50%",position:"relative",height:"150px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,A.jsx)(c.Z,{color:"black"})}):(0,A.jsx)(u.Z,{sx:{width:"150px",height:"150px"},src:(0,k.FG)(null===(e=D.userInfo)||void 0===e?void 0:e.image),alt:null===(n=D.userInfo)||void 0===n?void 0:n.fullName}),(0,A.jsx)(d.Z,{title:"Upload Photo",children:(0,A.jsxs)(x.Z,{size:"small",sx:{position:"absolute",top:100,right:0},color:"secondary",component:"label",children:[(0,A.jsx)(P.IYd,{}),(0,A.jsx)("input",{hidden:!0,accept:"image/*",type:"file",onChange:function(e){T(e.target.files[0])}})]})})]}),(0,A.jsxs)(m.Z,{direction:"column",sx:{alignItems:{xs:"center",sm:"flex-start"}},children:[(0,A.jsxs)(p.Z,{variant:"h6",sx:{display:"flex",alignItems:"center",columnGap:1},children:[(0,A.jsx)("b",{children:null===(t=D.userInfo)||void 0===t?void 0:t.userName}),(0,A.jsx)(f.Z,{smDown:!0,children:(0,A.jsx)(h.Z,{size:"small",onClick:function(){return R(!q)},children:(0,A.jsx)(P.IYd,{})})})]}),(0,A.jsxs)(p.Z,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",columnGap:1,mt:{sm:.5}},children:[(0,A.jsx)(f.Z,{smDown:!0,children:(0,A.jsx)(re.i77,{})}),(0,A.jsx)("span",{children:null===(v=D.userInfo)||void 0===v?void 0:v.fullName})]}),(0,A.jsxs)(p.Z,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",columnGap:1},children:[(0,A.jsx)(f.Z,{smDown:!0,children:(0,A.jsx)(I.DNl,{})}),(0,A.jsx)("span",{children:null===(E=D.userInfo)||void 0===E?void 0:E.phone})]}),(0,A.jsxs)(p.Z,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",columnGap:1},children:[(0,A.jsx)(f.Z,{smDown:!0,children:(0,A.jsx)(S.tzA,{})}),(0,A.jsx)("span",{children:null===(_=D.userInfo)||void 0===_?void 0:_.email})]})]}),(0,A.jsxs)(o.ZP,{item:!0,xs:12,sx:{height:"100%",display:"flex",flexDirection:"column",alignItems:{xs:"center",sm:"flex-end"},justifyContent:"flex-start"},children:[(0,A.jsx)(f.Z,{smDown:!0,children:(0,A.jsxs)(j.Z,{variant:"outlined",size:"small",startIcon:(0,A.jsx)(C.JO,{icon:"wpf:password1"}),sx:{borderRadius:"40px"},onClick:function(){return M(!Q)},children:[(0,A.jsx)(f.Z,{mdDown:!0,children:"update password"}),(0,A.jsx)(f.Z,{mdUp:!0,children:"Security"})]})}),(0,A.jsxs)(f.Z,{smUp:!0,children:[(0,A.jsx)(j.Z,{variant:"contained",size:"small",startIcon:(0,A.jsx)(P.IYd,{}),sx:{borderRadius:"40px"},onClick:function(){return R(!q)},children:"update account"}),(0,A.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:{mt:1,rowGap:1,columnGap:1},children:[(0,A.jsx)(h.Z,{color:"primary",onClick:function(){return M(!Q)},children:(0,A.jsx)(C.JO,{icon:"wpf:password1"})}),(0,A.jsx)(h.Z,{color:"error",onClick:function(){return D.logout()},children:(0,A.jsx)(U.lE7,{})})]})]}),(0,A.jsx)(Z.Z,{orientation:"vertical","aria-label":"vertical contained button group",variant:"contained"})]})]})}),(0,A.jsx)(l.Z,{sx:{my:1,maxWidth:"99vw",mx:"auto",px:1,mt:2},children:(0,A.jsx)(ie,{})}),(0,A.jsx)(H,{open:q,onClose:function(){return R(!q)}}),(0,A.jsx)($,{open:Q,onClose:function(){return M(!Q)}})]}):(0,A.jsxs)(m.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:2,sx:{minHeight:"70vh"},children:[(0,A.jsx)(u.Z,{sx:{width:"220px",height:"180px",borderRadius:0,mb:7},src:y.Z}),(0,A.jsx)(j.Z,{color:"black",variant:"contained",onClick:D.handleOpen,children:"Sign In"}),(0,A.jsx)(g.Z,{sx:{width:"100%",maxWidth:"300px"},children:"OR"}),(0,A.jsx)(j.Z,{color:"black",variant:"outlined",onClick:D.handleOpenCreate,children:"Sign Up"})]})}},7676:function(e,n,t){t.d(n,{BH:function(){return d},OA:function(){return x},Ss:function(){return s},g2:function(){return c},nC:function(){return o}});var r=t(56),i=t(7347),s=function(e){return(0,r.useQuery)(["get-prod-by-id",e],(function(){return function(e){return i.ZP.get("product/".concat(e))}(e)}),{enabled:!!e,retry:1})},a=function(e){var n=e.queryKey,t=e.pageParam,r=void 0===t?1:t;return i.ZP.get("search",{params:{search:n[1],page:r}})},o=function(e){var n=e.search;return(0,r.useInfiniteQuery)(["Infinite-Subcatprod-List",n],a,{select:function(e){return e.pages.flatMap((function(e){return e.data.data}))},getNextPageParam:function(e){if(e.data.page*e.data.limit<e.data.total)return e.data.page+1},enabled:!!n})},l=function(e){return i.ZP.put("bookmark/".concat(e))},c=function(){var e=(0,r.useQueryClient)();return(0,r.useMutation)(l,{onSuccess:function(){e.invalidateQueries("user-validate"),e.invalidateQueries("Bookmark-List"),e.invalidateQueries("Infinite-Bookmark-List")}})},u=function(e){var n=e.pageParam,t=void 0===n?1:n,r=e.limit;return i.ZP.get("bookmark",{params:{page:t,limit:r}})},d=function(e){var n=e.page,t=void 0===n?1:n,i=e.limit;return(0,r.useQuery)(["Bookmark-List",t,i],(function(){return u({pageParam:t,limit:i})}),{})},x=function(){return(0,r.useInfiniteQuery)(["Infinite-Bookmark-List"],u,{select:function(e){return e.pages.flatMap((function(e){return e.data.data}))},getNextPageParam:function(e){if(e.data.page*e.data.limit<e.data.total)return e.data.page+1}})}}}]);